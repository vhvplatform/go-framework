@startuml developer-workflow
!theme plain
skinparam backgroundColor #FFFFFF
skinparam defaultFontName Arial
skinparam defaultFontSize 12

title Developer Workflow Using go-devtools

' Define colors
!define PRIMARY_COLOR #4A90E2
!define SECONDARY_COLOR #50C878
!define TERTIARY_COLOR #FFB84D
!define INFO_COLOR #9B59B6

' Start
start

' Initial Setup Phase
partition "Initial Setup (One-time)" #PRIMARY_COLOR {
    :Clone go-devtools repository;
    
    :Run **make setup**;
    note right
        Installs:
        - Docker Desktop
        - Go 1.23+
        - kubectl, Helm
        - Development tools
    end note
    
    :Clone service repositories;
    note right
        Workspace structure:
        ~/workspace/go-platform/
        ├── go-devtools/
        ├── auth-service/
        ├── user-service/
        └── ...
    end note
    
    :Configure environment variables;
    note right
        Edit docker/.env
        - JWT_SECRET
        - Database settings
        - SMTP config
    end note
}

' Daily Development Phase
partition "Daily Development" #SECONDARY_COLOR {
    :Start all services with **make start**;
    note right
        Starts:
        - All microservices
        - MongoDB, Redis, RabbitMQ
        - Prometheus, Grafana, Jaeger
    end note
    
    :Check service status;
    note right
        **make status**
        Shows health of all services
    end note
    
    if (All services healthy?) then (yes)
        :Begin development work;
    else (no)
        :View logs: **make logs-service SERVICE=xxx**;
        :Debug and fix issues;
        :Restart service: **make restart-service SERVICE=xxx**;
    endif
}

' Development Cycle
partition "Development Cycle" #TERTIARY_COLOR {
    while (Feature complete?) is (no)
        :Edit code in VS Code;
        
        if (Using hot-reload?) then (yes)
            :Code changes auto-reload;
            note right
                Start with:
                **make start-dev**
            end note
        else (no)
            :Rebuild service;
            note right
                **make rebuild SERVICE=xxx**
            end note
        endif
        
        :Test locally;
        
        if (API testing needed?) then (yes)
            :Use Postman collections;
            note right
                Collections in postman/
                Or: **make test-api**
            end note
        endif
        
        :Run unit tests;
        note right
            **make test-unit**
        end note
        
        if (Tests pass?) then (no)
            :Fix code and tests;
        endif
    endwhile (yes)
}

' Integration Testing Phase
partition "Integration Testing" #INFO_COLOR {
    :Seed test data;
    note right
        **make db-seed**
    end note
    
    :Run integration tests;
    note right
        **make test-integration**
    end note
    
    :Run E2E tests;
    note right
        **make test-e2e**
    end note
    
    if (Need load testing?) then (yes)
        :Run load tests;
        note right
            **make test-load**
        end note
    endif
}

' Monitoring & Debugging
partition "Monitoring & Debugging" #PRIMARY_COLOR {
    if (Issues detected?) then (yes)
        :Open Grafana dashboards;
        note right
            **make open-grafana**
            - View metrics
            - Check resource usage
        end note
        
        :Check distributed tracing;
        note right
            **make open-jaeger**
            - Trace requests
            - Find bottlenecks
        end note
        
        :View service logs;
        note right
            **make logs-service SERVICE=xxx**
        end note
        
        :Access service shell if needed;
        note right
            **make shell SERVICE=xxx**
        end note
    endif
}

' Deployment Phase
partition "Deployment" #SECONDARY_COLOR {
    :Commit and push changes;
    
    if (Deploy to local K8s?) then (yes)
        :Deploy to local cluster;
        note right
            **make deploy-local**
            Uses minikube/kind
        end note
        
        :Setup port forwarding;
        note right
            **make port-forward**
        end note
    endif
    
    if (Deploy to dev environment?) then (yes)
        :Deploy to development;
        note right
            **make deploy-dev**
        end note
    endif
}

' Cleanup Phase
partition "Daily Cleanup" #TERTIARY_COLOR {
    :Stop services;
    note right
        **make stop**
        Keeps data volumes
    end note
    
    if (Need fresh start tomorrow?) then (yes)
        :Clean all data;
        note right
            **make clean-all**
            Deletes volumes
        end note
    endif
}

' Common Utilities
note right
    **Utility Commands:**
    - make generate-jwt (Test tokens)
    - make health (Quick health check)
    - make info (Service URLs)
    - make version (Tool versions)
    - make open-rabbitmq (Queue management)
    - make db-backup (Backup database)
    - make db-restore FILE=xxx (Restore backup)
end note

stop

@enduml
